<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="like">
	<!-- 유저의 좋아요 유무, 없으면 insert, 있으면 select --> 
	<select id="likeCount" resultType="Integer" parameterType="LikeDto">
		select count(* ) from board_like where bno = #{bno} and mid = #{mid}
	</select>
	
	<!-- 좋아요 -->
	<insert id="likeInsert" parameterType="LikeDto">
		insert into board_like (bno, mid) values (#{bno}, #{mid})
	</insert>
	
    <!-- 좋아요 불러오기 -->  
    <select id="likeGet" resultType="Integer" parameterType="LikeDto">
   		select like_no from board_like where bno = #{bno} and mid = #{mid}
    </select>
 				
	<sql id="cal">
	    <choose>
	        <when test="count == 1">
	            like_no = 0
	        </when>
	        <otherwise>
	            like_no = like_no + 1
	        </otherwise>
	    </choose>
	</sql>		
	<update id="likeUpdate" parameterType="LikeDto">
			update board_like
			set <include refid="cal"></include>
			where mid = #{mid} and bno = #{bno}
	</update>

	
</mapper>
